<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!--회원 -->
<sqlMap namespace="admin">
	<select id="isExistadminId" parameterClass="String" resultClass="int">
		select count(*) 
		from admin
		where admin_id = #admin_id#
	</select>
	
	<select id="isExistAccount" parameterClass="Map" resultClass="int">
		select count(*) 
		from admin 
		where admin_id = #mem_id# 
		and admin_pw = #mem_pw#
	</select>
	
	<select id="getLctMember" resultClass="LineChartVO">
		SELECT
		MEMA.*, MEMB.*, MEMC.*, MEMD.*,
		LCTA.*, LCTB.*, LCTC.*, LCTD.*,
		LSNA.*, LSNB.*, LSNC.*, LSND.*
		FROM 
		(SELECT COUNT(*) AS MEM_BEFORE_0MONTH FROM MEMBER WHERE TO_CHAR(MEM_JOIN_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')) MEMA,
		(SELECT COUNT(*) AS MEM_BEFORE_1MONTH FROM MEMBER WHERE TO_CHAR(MEM_JOIN_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-1) MEMB,
		(SELECT COUNT(*) AS MEM_BEFORE_2MONTH FROM MEMBER WHERE TO_CHAR(MEM_JOIN_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-2) MEMC,
		(SELECT COUNT(*) AS MEM_BEFORE_3MONTH FROM MEMBER WHERE TO_CHAR(MEM_JOIN_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-3) MEMD,
		
		(SELECT COUNT(*) AS LCT_BEFORE_0MONTH FROM LECTURE WHERE TO_CHAR(LCT_UPLOAD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')) LCTA,
		(SELECT COUNT(*) AS LCT_BEFORE_1MONTH FROM LECTURE WHERE TO_CHAR(LCT_UPLOAD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-1) LCTB,
		(SELECT COUNT(*) AS LCT_BEFORE_2MONTH FROM LECTURE WHERE TO_CHAR(LCT_UPLOAD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-2) LCTC,
		(SELECT COUNT(*) AS LCT_BEFORE_3MONTH FROM LECTURE WHERE TO_CHAR(LCT_UPLOAD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-3) LCTD,
		
		(SELECT COUNT(*) AS LSN_BEFORE_0MONTH FROM LBOARD WHERE TO_CHAR(LSN_BOARD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')) LSNA,
		(SELECT COUNT(*) AS LSN_BEFORE_1MONTH FROM LBOARD WHERE TO_CHAR(LSN_BOARD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-1) LSNB,
		(SELECT COUNT(*) AS LSN_BEFORE_2MONTH FROM LBOARD WHERE TO_CHAR(LSN_BOARD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-2) LSNC,
		(SELECT COUNT(*) AS LSN_BEFORE_3MONTH FROM LBOARD WHERE TO_CHAR(LSN_BOARD_DATE,'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')-3) LSND
	</select>
	
	<select id="getAllmemberlist" resultClass="RepotMemberVO">
		SELECT  MEM_ID, 
        MEM_NAME, 
        MEM_ADDR||' '||MEM_DTLADDR AS MEM_ADDR,
        LANG_ITRST, 
        LANG_MAJOR, 
        NVL(B.RPT_CNT,0) AS RPT_CNT
		FROM    MEMBER A,
		(SELECT COUNT(*) AS RPT_CNT, RPT_TARGET	
		FROM REPORT
		GROUP BY RPT_TARGET) B
		WHERE A.MEM_ID= B.RPT_TARGET(+)
	</select>
	
	
	
</sqlMap>